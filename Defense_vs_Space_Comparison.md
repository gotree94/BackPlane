# Tier 3: 프리미엄 자율 보전 시스템

> 핵심 병목 설비를 위한 멀티모달 AI 기반 자율 예지보전 시스템 ($300~500/자산)

[![Platform](https://img.shields.io/badge/Platform-Jetson%20AGX%20Orin-76B900.svg)]()
[![AI](https://img.shields.io/badge/AI-Edge%20LLM%20%7C%20Agentic%20AI-blue.svg)]()
[![Sensors](https://img.shields.io/badge/Sensors-Multimodal%205CH-orange.svg)]()
[![CMMS](https://img.shields.io/badge/Integration-CMMS%20%7C%20MES%20%7C%20ERP-purple.svg)]()

---

## 📋 목차

1. [개요](#개요)
2. [시스템 아키텍처](#시스템-아키텍처)
3. [하드웨어 구성](#하드웨어-구성)
4. [소프트웨어 스택](#소프트웨어-스택)
5. [멀티모달 센서 융합](#멀티모달-센서-융합)
6. [Edge LLM 및 Agentic AI](#edge-llm-및-agentic-ai)
7. [CMMS/MES 연동](#cmsmes-연동)
8. [음성 인터페이스](#음성-인터페이스)
9. [디지털 트윈 통합](#디지털-트윈-통합)
10. [배포 및 운영](#배포-및-운영)
11. [비용 분석](#비용-분석)
12. [참고 자료](#참고-자료)

---

## 개요

### Tier 3 정의

Tier 3는 예지보전 시스템의 최상위 단계로, 공장 내 핵심 병목 설비(Critical Bottleneck Assets)에 적용됩니다. 단순 이상 탐지를 넘어 자율적인 진단, 작업 지시 생성, 음성 기반 현장 인터페이스까지 제공하는 풀스택 AI 솔루션입니다.

### 핵심 특징

| 구분 | 설명 |
|:----:|------|
| **대상 설비** | 프레스, 대형 CNC, 핵심 용접 로봇, 도장 라인 |
| **적용 규모** | 공장당 50~100대 (전체 설비의 5~10%) |
| **센서 구성** | 5채널 멀티모달 (진동 + 음향 + 비전 + 열화상 + 전력) |
| **AI 레벨** | Edge LLM + Agentic AI + 디지털 트윈 |
| **연동** | CMMS/MES/ERP 실시간 통합 |
| **투자비** | $300~500/자산 (공유 장비 별도) |

### Tier 1/2/3 비교

```
┌────────────────────────────────────────────────────────────────────────────┐
│                          예지보전 시스템 Tier 비교                          │
├────────────────────────────────────────────────────────────────────────────┤
│                                                                            │
│  Tier 1 ($20~50)          Tier 2 ($100~200)        Tier 3 ($300~500)       │
│  ─────────────────        ─────────────────        ─────────────────       │
│  • ESP32/STM32            • Jetson Nano/Orin NX    • Jetson AGX Orin       │
│  • MEMS 센서              • 고급 MEMS + 산업용     • 산업용 센서 풀세트     │
│  • 임계값 + TinyML        • CNN-LSTM 예측          • Edge LLM + Agentic    │
│  • 이상 탐지              • 고장 예측 (RUL)        • 자율 진단 + 작업지시   │
│  • MQTT 전송              • Edge 추론              • Voice-to-CMMS         │
│  • 수백~수천 대           • 수십~수백 대           • 50~100대               │
│                                                                            │
└────────────────────────────────────────────────────────────────────────────┘
```

---

## 시스템 아키텍처

### 전체 구성도

```
┌──────────────────────────────────────────────────────────────────────────────────┐
│                        Tier 3 자율 보전 시스템 아키텍처                            │
├──────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                         멀티모달 센서 레이어                              │    │
│  ├─────────────────────────────────────────────────────────────────────────┤    │
│  │                                                                         │    │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐  │    │
│  │  │ 산업용   │  │ 산업용   │  │ 고해상도 │  │ 열화상   │  │ 전력     │  │    │
│  │  │ 진동센서 │  │ 마이크   │  │ 카메라   │  │ 카메라   │  │ 분석기   │  │    │
│  │  │ PCB 603C │  │ GRAS 46AE│  │ IMX477   │  │ Lepton   │  │ ACS37800 │  │    │
│  │  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘  │    │
│  │       │             │             │             │             │        │    │
│  │       │   SPI/I2S   │    I2S      │    CSI-2    │    I2C      │  SPI   │    │
│  │       └──────┬──────┴──────┬──────┴──────┬──────┴──────┬──────┴────────┘    │
│  │              │             │             │             │                    │
│  └──────────────┼─────────────┼─────────────┼─────────────┼────────────────────┘
│                 │             │             │             │                     │
│                 ▼             ▼             ▼             ▼                     │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                     STM32H7 데이터 수집 허브                             │    │
│  │  • 고속 ADC (24-bit, 102.4kHz) 멀티채널 동기 샘플링                      │    │
│  │  • 실시간 FFT/Envelope 전처리                                            │    │
│  │  • 데이터 압축 및 타임스탬프 동기화                                      │    │
│  └──────────────────────────────┬──────────────────────────────────────────┘    │
│                                 │                                               │
│                          Ethernet/USB 3.0                                       │
│                                 │                                               │
│                                 ▼                                               │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                    Jetson AGX Orin (200+ TOPS)                          │    │
│  ├─────────────────────────────────────────────────────────────────────────┤    │
│  │                                                                         │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌─────────────┐  │    │
│  │  │ 센서 융합    │  │ Edge LLM     │  │ Agentic AI   │  │ Voice       │  │    │
│  │  │ Engine       │  │ (Phi-3/Llama)│  │ Orchestrator │  │ Interface   │  │    │
│  │  │              │  │              │  │              │  │             │  │    │
│  │  │ • 멀티모달   │  │ • 자연어     │  │ • ReAct      │  │ • ASR/TTS   │  │    │
│  │  │   특징 추출  │  │   진단 생성  │  │   추론 체인  │  │ • 웨이크    │  │    │
│  │  │ • Attention  │  │ • 컨텍스트   │  │ • 도구 호출  │  │   워드      │  │    │
│  │  │   기반 융합  │  │   이해       │  │ • 작업 생성  │  │             │  │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘  └─────────────┘  │    │
│  │                                                                         │    │
│  │  ┌─────────────────────────────────────────────────────────────────┐    │    │
│  │  │                    Knowledge Base & Vector DB                   │    │    │
│  │  │  • 설비 매뉴얼, 정비 이력, 고장 사례 RAG                         │    │    │
│  │  │  • ChromaDB / Milvus (로컬)                                     │    │    │
│  │  └─────────────────────────────────────────────────────────────────┘    │    │
│  │                                                                         │    │
│  └──────────────────────────────┬──────────────────────────────────────────┘    │
│                                 │                                               │
│                      OPC-UA / MQTT / REST API                                   │
│                                 │                                               │
│                                 ▼                                               │
│  ┌─────────────────────────────────────────────────────────────────────────┐    │
│  │                        Enterprise Integration                           │    │
│  ├─────────────────────────────────────────────────────────────────────────┤    │
│  │                                                                         │    │
│  │   ┌──────────┐      ┌──────────┐      ┌──────────┐      ┌──────────┐   │    │
│  │   │  CMMS    │      │   MES    │      │   ERP    │      │ Digital  │   │    │
│  │   │ SAP PM   │◄────►│ Siemens  │◄────►│ SAP S/4  │◄────►│  Twin    │   │    │
│  │   │ Maximo   │      │ Opcenter │      │ HANA     │      │ Omniverse│   │    │
│  │   └──────────┘      └──────────┘      └──────────┘      └──────────┘   │    │
│  │                                                                         │    │
│  └─────────────────────────────────────────────────────────────────────────┘    │
│                                                                                  │
└──────────────────────────────────────────────────────────────────────────────────┘
```

### 데이터 흐름

```
[센서] ──► [STM32H7] ──► [Jetson AGX Orin] ──► [Enterprise Systems]
                              │
                              ├── 센서 융합 추론 (10ms 주기)
                              ├── Edge LLM 진단 (요청 시)
                              ├── Agentic 작업 생성 (이벤트 기반)
                              └── 음성 인터페이스 (상시 대기)
```

---

## 하드웨어 구성

### Edge AI 프로세서

| 구분 | 부품명 | 사양 | 예상 단가 | 비고 |
|:----:|--------|------|----------:|------|
| **메인** | Jetson AGX Orin 32GB | 200 TOPS, Ampere GPU | $999 | 노드당 1대 또는 다중 설비 공유 |
| **대안** | Jetson Orin NX 16GB | 100 TOPS | $599 | 단일 설비 전용 시 |
| **가속기** | Hailo-8 M.2 | 26 TOPS | $100~150 | 추가 추론 가속 |
| **스토리지** | 256GB NVMe | Samsung 980 Pro | $30~50 | 고속 데이터 로깅 |

### 산업용 진동 센서

| 구분 | 부품명 | 사양 | 예상 단가 | 비고 |
|:----:|--------|------|----------:|------|
| **ICP 가속도계** | PCB 603C01 | ±50g, 0.5~10kHz, ICP | $150~300 | 산업 표준, 고신뢰성 |
| **4-20mA 출력** | Hansford HS-100 | ±50g, 4-20mA | $100~200 | PLC 직접 연결 가능 |
| **IEPE** | Dytran 3055D1 | ±50g, 0.5~15kHz | $200~350 | 고주파 분석 |
| **MEMS 고급** | Analog ADXL1002 | ±50g, DC~11kHz | $30~50 | MEMS 최고 성능 |

### 산업용 음향 센서

| 구분 | 부품명 | 사양 | 예상 단가 | 비고 |
|:----:|--------|------|----------:|------|
| **측정용 마이크** | GRAS 46AE | 3.15Hz~20kHz, ICP | $200~400 | 정밀 음향 분석 |
| **ICP 마이크** | PCB 378B02 | 3.15Hz~10kHz | $150~250 | 산업 환경용 |
| **초음파** | Murata MA40S4S | 40kHz 초음파 | $5~10 | 누설/마찰 감지 |
| **MEMS 어레이** | ICS-43434 x4 | I2S, 빔포밍 | $15~25 | 음원 위치 추정 |

### 비전 시스템

| 구분 | 부품명 | 사양 | 예상 단가 | 비고 |
|:----:|--------|------|----------:|------|
| **고해상도** | IMX477 12.3MP | C/CS 마운트, CSI-2 | $50~80 | 상세 이미지 분석 |
| **64MP 옵션** | Arducam Hawkeye | 64MP, 오토포커스 | $40~60 | 초고해상도 |
| **3D 비전** | OAK-D Pro | 스테레오 + IMU + ToF | $250~300 | 깊이 + 모션 |
| **산업용** | FLIR BFS-U3-51S5C | 5MP, GigE, IP67 | $400~600 | 방진/방수 |

### 열화상 카메라

| 구분 | 부품명 | 사양 | 예상 단가 | 비고 |
|:----:|--------|------|----------:|------|
| **고해상도** | FLIR Lepton 3.5 | 160×120, -10~400°C | $200~250 | 소형/저전력 |
| **대안** | Seek Thermal | 206×156 | $250~300 | 더 높은 해상도 |
| **산업용** | MLX90640 | 32×24, -40~300°C | $50~80 | 저비용 옵션 |

### 전력 분석

| 구분 | 부품명 | 사양 | 예상 단가 | 비고 |
|:----:|--------|------|----------:|------|
| **통합 IC** | ACS37800 | 전압/전류/전력, SPI | $15~25 | 단상 분석 |
| **클램프 CT** | Hioki CT6904 | 최대 500A | $100~200 | 비침습 측정 |
| **전력 분석기** | Yokogawa WT310E | 고정밀, GPIB | $1,000+ | 공유 장비 |

### 음성 인터페이스

| 구분 | 부품명 | 사양 | 예상 단가 | 비고 |
|:----:|--------|------|----------:|------|
| **마이크 어레이** | ReSpeaker 4-Mic | 4채널, USB | $30~50 | 방향 탐지 |
| **웨이크워드** | Seeed XIAO ESP32S3 | 저전력 KWS | $15~25 | 상시 대기 |
| **스피커** | 산업용 스피커 | 방수, 고음량 | $30~50 | 소음 환경 대응 |

### 산업 통신

| 구분 | 부품명 | 사양 | 예상 단가 | 비고 |
|:----:|--------|------|----------:|------|
| **EtherCAT** | LAN9252 슬레이브 | 실시간 통신 | $30~50 | 1ms 미만 레이턴시 |
| **PROFINET** | HMS Anybus | 산업 이더넷 | $50~100 | Siemens 호환 |
| **OPC-UA** | 소프트웨어 | open62541 | 무료 | 표준 연동 |

### 하드웨어 구성 총괄

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    Tier 3 노드 하드웨어 구성 (1대 기준)                   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  Edge AI                                           예상 비용    │   │
│  │  ├── Jetson AGX Orin 32GB ────────────────────────── $999      │   │
│  │  └── 256GB NVMe SSD ──────────────────────────────── $40       │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  센서 시스템                                                     │   │
│  │  ├── 진동: PCB 603C01 ────────────────────────────── $200      │   │
│  │  ├── 음향: GRAS 46AE ─────────────────────────────── $300      │   │
│  │  ├── 비전: IMX477 + 렌즈 ─────────────────────────── $80       │   │
│  │  ├── 열화상: FLIR Lepton 3.5 ─────────────────────── $220      │   │
│  │  └── 전력: ACS37800 ──────────────────────────────── $20       │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  데이터 수집 & 통신                                              │   │
│  │  ├── STM32H7 + ADC 보드 ──────────────────────────── $50       │   │
│  │  ├── 음성 인터페이스 ─────────────────────────────── $50       │   │
│  │  └── 산업 통신 (EtherCAT/PROFINET) ───────────────── $50       │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │  기타                                                            │   │
│  │  ├── IP65 산업용 케이스 ──────────────────────────── $100      │   │
│  │  ├── 전원 공급 장치 ──────────────────────────────── $50       │   │
│  │  └── 케이블/커넥터/마운트 ────────────────────────── $40       │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
│  ══════════════════════════════════════════════════════════════════    │
│                              총계: $2,199/노드                          │
│  ══════════════════════════════════════════════════════════════════    │
│                                                                         │
│  * Jetson AGX Orin 공유 시 (4~5대 설비당 1대): $400~500/자산            │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 소프트웨어 스택

### 시스템 소프트웨어

| 구분 | 도구/라이브러리 | 버전 | 용도 |
|:----:|-----------------|:----:|------|
| **OS** | JetPack | 6.x | Jetson 최적화 Ubuntu |
| **컨테이너** | Docker + NVIDIA Container | Latest | 마이크로서비스 배포 |
| **오케스트레이션** | K3s | Latest | 경량 쿠버네티스 |

### AI/ML 프레임워크

| 구분 | 도구/라이브러리 | 용도 |
|:----:|-----------------|------|
| **딥러닝** | PyTorch 2.x + TorchAudio | 모델 학습/추론 |
| **추론 최적화** | TensorRT | Jetson GPU 가속 |
| **ONNX** | ONNX Runtime | 모델 호환성 |
| **멀티모달** | HuggingFace Transformers | 사전학습 모델 |

### Edge LLM

| 구분 | 도구/라이브러리 | 용도 |
|:----:|-----------------|------|
| **LLM 런타임** | Ollama / llama.cpp | 로컬 LLM 추론 |
| **모델** | Phi-3-mini-4k (3.8B) | 진단 생성, 경량 |
| **모델** | Llama-3.2-3B | 한국어 지원 |
| **모델** | Qwen2.5-3B | 다국어 |
| **RAG** | LangChain | 검색 증강 생성 |
| **벡터DB** | ChromaDB / Milvus Lite | 임베딩 저장 |

### 음성 처리

| 구분 | 도구/라이브러리 | 용도 |
|:----:|-----------------|------|
| **ASR** | Whisper (small/medium) | 음성→텍스트 |
| **TTS** | Piper / VITS | 텍스트→음성 |
| **웨이크워드** | OpenWakeWord | 저전력 KWS |
| **노이즈 제거** | RNNoise | 산업 환경 잡음 |

### 신호 처리

| 구분 | 도구/라이브러리 | 용도 |
|:----:|-----------------|------|
| **DSP** | SciPy / NumPy | FFT, 필터링 |
| **음향** | Librosa | 스펙트로그램, MFCC |
| **비전** | OpenCV + CUDA | 이미지 처리 |
| **열화상** | OpenCV | 온도맵 분석 |

### 데이터 파이프라인

| 구분 | 도구/라이브러리 | 용도 |
|:----:|-----------------|------|
| **스트리밍** | Apache Kafka / Redis Streams | 실시간 데이터 |
| **시계열 DB** | InfluxDB / TimescaleDB | 센서 데이터 저장 |
| **대시보드** | Grafana | 시각화/모니터링 |

### Enterprise 연동

| 구분 | 도구/라이브러리 | 용도 |
|:----:|-----------------|------|
| **OPC-UA** | open62541 / python-opcua | 산업 표준 통신 |
| **MQTT** | Eclipse Mosquitto | IoT 메시징 |
| **REST** | FastAPI | API 서버 |
| **gRPC** | grpcio | 고성능 RPC |

---

## 멀티모달 센서 융합

### 센서별 역할

| 센서 | 감지 대상 | 주파수/해상도 | 분석 기법 |
|:----:|----------|:-------------:|----------|
| **진동** | 베어링, 기어, 불균형 | DC~10kHz | FFT, Envelope, Order |
| **음향** | 마찰, 누설, 캐비테이션 | 20Hz~20kHz | MFCC, Mel-Spectrogram |
| **비전** | 크랙, 마모, 오염 | 12MP, 30fps | CNN, Object Detection |
| **열화상** | 과열, 누유, 마찰열 | 160×120, 9Hz | 온도 이상 영역 |
| **전력** | 과부하, 효율 저하 | 1kHz | 고조파, 역률 분석 |

### 센서 융합 아키텍처

```
┌──────────────────────────────────────────────────────────────────────────┐
│                        멀티모달 센서 융합 파이프라인                       │
├──────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌──────────────────────────────────────────────────────────────────┐   │
│  │                    특징 추출 (Feature Extraction)                 │   │
│  │                                                                   │   │
│  │  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │   │
│  │  │ 진동    │  │ 음향    │  │ 비전    │  │ 열화상  │  │ 전력    │ │   │
│  │  │ ────────│  │ ────────│  │ ────────│  │ ────────│  │ ────────│ │   │
│  │  │ FFT     │  │ MFCC    │  │ CNN     │  │ Thermal │  │ Power   │ │   │
│  │  │ Envelope│  │ Mel-    │  │ Feature │  │ Feature │  │ Quality │ │   │
│  │  │ RMS     │  │ Spectro │  │ (ResNet)│  │ (Hot    │  │ (THD,   │ │   │
│  │  │ Kurtosis│  │ HPSS    │  │         │  │ Spots)  │  │ PF)     │ │   │
│  │  │         │  │         │  │         │  │         │  │         │ │   │
│  │  │ [128D]  │  │ [128D]  │  │ [256D]  │  │ [64D]   │  │ [32D]   │ │   │
│  │  └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘ │   │
│  │       │            │            │            │            │      │   │
│  └───────┼────────────┼────────────┼────────────┼────────────┼──────┘   │
│          │            │            │            │            │          │
│          └────────────┴─────┬──────┴────────────┴────────────┘          │
│                             │                                            │
│                             ▼                                            │
│  ┌──────────────────────────────────────────────────────────────────┐   │
│  │                    융합 레이어 (Fusion Layer)                     │   │
│  │                                                                   │   │
│  │  ┌─────────────────────────────────────────────────────────────┐ │   │
│  │  │              Cross-Modal Attention Fusion                   │ │   │
│  │  │                                                             │ │   │
│  │  │   [Vib]──┐                                                  │ │   │
│  │  │   [Aco]──┼──► Multi-Head ──► Concat ──► FC ──► [608D]      │ │   │
│  │  │   [Vis]──┤   Attention                                      │ │   │
│  │  │   [Thm]──┤                                                  │ │   │
│  │  │   [Pow]──┘                                                  │ │   │
│  │  └─────────────────────────────────────────────────────────────┘ │   │
│  └──────────────────────────────────────────────────────────────────┘   │
│                             │                                            │
│                             ▼                                            │
│  ┌──────────────────────────────────────────────────────────────────┐   │
│  │                    멀티태스크 헤드 (Multi-Task Heads)             │   │
│  │                                                                   │   │
│  │  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────────┐  │   │
│  │  │ Anomaly   │  │ Fault     │  │ RUL       │  │ Severity      │  │   │
│  │  │ Score     │  │ Type      │  │ Prediction│  │ Level         │  │   │
│  │  │ [0~1]     │  │ [N Class] │  │ [Days]    │  │ [1~5]         │  │   │
│  │  └───────────┘  └───────────┘  └───────────┘  └───────────────┘  │   │
│  │                                                                   │   │
│  └──────────────────────────────────────────────────────────────────┘   │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

### 융합 전략 예시 코드

```python
# 센서 융합 예시 코드 (PyTorch)
class MultimodalFusion(nn.Module):
    def __init__(self):
        super().__init__()
        # 각 모달리티 인코더
        self.vib_encoder = VibrationEncoder(out_dim=128)
        self.aco_encoder = AcousticEncoder(out_dim=128)
        self.vis_encoder = VisionEncoder(out_dim=256)
        self.thm_encoder = ThermalEncoder(out_dim=64)
        self.pow_encoder = PowerEncoder(out_dim=32)
        
        # Cross-Modal Attention
        self.cross_attention = nn.MultiheadAttention(
            embed_dim=128, num_heads=8, batch_first=True
        )
        
        # Fusion Layer
        self.fusion_fc = nn.Sequential(
            nn.Linear(608, 256),
            nn.ReLU(),
            nn.Dropout(0.3),
            nn.Linear(256, 128)
        )
        
        # Multi-Task Heads
        self.anomaly_head = nn.Linear(128, 1)   # 이상 점수
        self.fault_head = nn.Linear(128, 10)    # 고장 유형 분류
        self.rul_head = nn.Linear(128, 1)       # 잔여 수명
        self.severity_head = nn.Linear(128, 5)  # 심각도
    
    def forward(self, vib, aco, vis, thm, pow):
        # 특징 추출
        f_vib = self.vib_encoder(vib)
        f_aco = self.aco_encoder(aco)
        f_vis = self.vis_encoder(vis)
        f_thm = self.thm_encoder(thm)
        f_pow = self.pow_encoder(pow)
        
        # Attention 융합
        modal_stack = torch.stack([f_vib, f_aco], dim=1)
        attn_out, _ = self.cross_attention(modal_stack, modal_stack, modal_stack)
        
        # 전체 융합
        fused = torch.cat([attn_out.flatten(1), f_vis, f_thm, f_pow], dim=1)
        features = self.fusion_fc(fused)
        
        # 멀티태스크 출력
        return {
            'anomaly': torch.sigmoid(self.anomaly_head(features)),
            'fault': self.fault_head(features),
            'rul': torch.relu(self.rul_head(features)),
            'severity': self.severity_head(features)
        }
```

---

## Edge LLM 및 Agentic AI

### Edge LLM 구성

Tier 3의 핵심 차별화 요소는 Edge에서 실행되는 경량 LLM입니다.

#### 지원 모델

| 모델 | 파라미터 | VRAM | 용도 | 특징 |
|:----:|:--------:|:----:|------|------|
| **Phi-3-mini** | 3.8B | 4GB | 진단 생성 | 빠른 추론, 영어 최적화 |
| **Llama-3.2-3B** | 3B | 3GB | 다목적 | 한국어 지원 |
| **Qwen2.5-3B** | 3B | 3GB | 기술 문서 | 다국어, 코딩 |
| **Gemma-2-2B** | 2B | 2GB | 경량 태스크 | 초저지연 |

#### LLM 프롬프트 구조

```
┌──────────────────────────────────────────────────────────────────────────┐
│                        Edge LLM 진단 프롬프트 구조                        │
├──────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  [System Prompt]                                                         │
│  ─────────────────────────────────────────────────────────────────────   │
│  당신은 현대자동차 공장의 예지보전 전문가 AI입니다.                        │
│  설비 센서 데이터를 분석하여 고장 원인을 진단하고,                         │
│  작업 지시를 생성합니다. 한국어로 응답하세요.                              │
│                                                                          │
│  [RAG Context]                                                           │
│  ─────────────────────────────────────────────────────────────────────   │
│  관련 문서:                                                              │
│  - 프레스 P-001 정비 매뉴얼 (2024): 유압 펌프 베어링 교체 주기 2000시간   │
│  - 고장 이력 #2024-0523: 유사 증상으로 외륜 손상 확인                      │
│  - 부품 재고: SKF 6205-2RS (재고 5개, 리드타임 3일)                       │
│                                                                          │
│  [Sensor Summary]                                                        │
│  ─────────────────────────────────────────────────────────────────────   │
│  설비: 프레스 P-001 (유압 펌프 #2)                                        │
│  시간: 2024-11-15 14:32:15                                               │
│                                                                          │
│  진동: RMS 4.2mm/s (정상 1.5), BPFO 피크 검출 (외륜 결함 주파수)           │
│  음향: 마찰음 특성 검출 (850Hz 대역)                                       │
│  열화상: 베어링 하우징 72°C (정상 45°C)                                   │
│  전력: 전류 12% 증가, 역률 0.82 (정상 0.92)                               │
│                                                                          │
│  이상 점수: 0.87 (Critical)                                              │
│  예측 고장: 베어링 외륜 손상                                              │
│  예상 RUL: 5일                                                           │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

### Agentic AI 구조

```
┌──────────────────────────────────────────────────────────────────────────┐
│                        Agentic AI 아키텍처                                │
├──────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌────────────────────────────────────────────────────────────────────┐ │
│  │                         ReAct Agent                                │ │
│  │                                                                    │ │
│  │   [Thought] ──► [Action] ──► [Observation] ──► [Thought] ──► ...  │ │
│  └────────────────────────────────────────────────────────────────────┘ │
│                                                                          │
│  ┌────────────────────────────────────────────────────────────────────┐ │
│  │                       Available Tools                              │ │
│  │                                                                    │ │
│  │  • sensor_query    : 센서 데이터 조회                              │ │
│  │  • rag_search      : 매뉴얼/이력 검색                              │ │
│  │  • cmms_create     : 작업지시 생성                                 │ │
│  │  • parts_lookup    : 부품 재고 조회                                │ │
│  │  • notify_worker   : 작업자 알림                                   │ │
│  │  • schedule_down   : 정지 스케줄링                                 │ │
│  │  • digital_twin    : 디지털 트윈 동기화                            │ │
│  │  • report_generate : 리포트 생성                                   │ │
│  │                                                                    │ │
│  └────────────────────────────────────────────────────────────────────┘ │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

### Agent 실행 예시

```
🎯 Trigger: 프레스 P-001 이상 점수 0.87 (Critical) 감지

[Step 1] Thought: 센서 데이터 상세 분석이 필요합니다.
         Action: sensor_query(asset_id="P-001", window="1h")
         Observation: 진동 RMS 4.2, BPFO 피크, 온도 72°C

[Step 2] Thought: 유사 고장 사례와 매뉴얼을 검색합니다.
         Action: rag_search(query="P-001 베어링 외륜 손상")
         Observation: 3건의 관련 문서 발견

[Step 3] Thought: 교체에 필요한 부품 재고를 확인합니다.
         Action: parts_lookup(part_no="SKF 6205-2RS")
         Observation: 재고 5개, 위치 A-12-3

[Step 4] Thought: 작업 지시를 CMMS에 등록합니다.
         Action: cmms_create_workorder(asset="P-001", priority="HIGH", ...)
         Observation: 작업지시 WO-2024-1115-001 생성 완료

[Step 5] Thought: 담당 작업자에게 알림을 보냅니다.
         Action: notify_worker(worker_id="M-042", channel=["sms", "app"])
         Observation: 알림 발송 완료

✅ Final Answer: P-001 유압 펌프 베어링 외륜 손상 감지하여 조치 완료
```

---

## 음성 인터페이스

### Voice-to-CMMS 워크플로우

```
"헤이 클로드, P-001 상태 알려줘"
         │
         ▼
┌─────────────────────────────────────────┐
│ 1. Wake Word Detection (OpenWakeWord)   │
│    └── "헤이 클로드" → 활성화           │
├─────────────────────────────────────────┤
│ 2. Speech-to-Text (Whisper)             │
│    └── "P-001 상태 알려줘" (한국어)     │
├─────────────────────────────────────────┤
│ 3. Intent + Entity Extraction           │
│    └── Intent: STATUS_QUERY             │
│    └── Entity: asset_id = "P-001"       │
├─────────────────────────────────────────┤
│ 4. Agent Execution                      │
│    └── sensor_query + health_status     │
├─────────────────────────────────────────┤
│ 5. Response Generation (Edge LLM)       │
│    └── 자연어 진단 결과 생성            │
├─────────────────────────────────────────┤
│ 6. Text-to-Speech (Piper/VITS)          │
│    └── 한국어 음성 합성                 │
└─────────────────────────────────────────┘
         │
         ▼
     🔊 음성 응답 출력
```

### 음성 명령 예시

| 명령 유형 | 예시 발화 | 동작 |
|:--------:|----------|------|
| **상태 조회** | "P-001 상태 알려줘" | 센서 + 건강 상태 요약 |
| **작업 생성** | "P-001 베어링 교체 작업지시 만들어줘" | CMMS 작업지시 생성 |
| **이력 조회** | "P-001 최근 정비 이력 보여줘" | 정비 이력 조회 |
| **알람 확인** | "오늘 발생한 알람 알려줘" | 알람 목록 조회 |
| **부품 조회** | "SKF 6205 재고 확인해줘" | 부품 재고 조회 |

---

## CMMS/MES 연동

### 연동 아키텍처

```
┌──────────────────────────────────────────────────────────────────────┐
│                     Enterprise 시스템 연동                            │
├──────────────────────────────────────────────────────────────────────┤
│                                                                      │
│   Tier 3 Edge Node                                                   │
│   ┌────────────────────────────────────────────────────────────────┐│
│   │  OPC-UA Client │ MQTT Client │ REST Client │ Kafka Connect     ││
│   └────────┬───────┴──────┬──────┴──────┬──────┴────────┬──────────┘│
│            │              │             │               │           │
│            ▼              ▼             ▼               ▼           │
│   ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌────────────┐│
│   │     CMMS     │ │     MES      │ │     ERP      │ │  Digital   ││
│   │   SAP PM     │ │   Siemens    │ │   SAP S/4    │ │   Twin     ││
│   │   Maximo     │ │   Opcenter   │ │   HANA       │ │  Omniverse ││
│   └──────────────┘ └──────────────┘ └──────────────┘ └────────────┘│
│                                                                      │
└──────────────────────────────────────────────────────────────────────┘
```

### CMMS 작업지시 데이터 모델

```json
{
  "work_order": {
    "wo_number": "WO-2024-1115-001",
    "asset_id": "P-001",
    "asset_name": "프레스 유압펌프 #2",
    "wo_type": "PREVENTIVE",
    "priority": "HIGH",
    "status": "PENDING",
    "created_by": "AI-TIER3-NODE-001",
    "diagnosis": {
      "source": "edge-llm-phi3",
      "confidence": 0.87,
      "fault_type": "BEARING_OUTER_RACE",
      "rul_days": 5
    },
    "parts_required": [
      {"part_number": "SKF 6205-2RS", "quantity": 1}
    ],
    "estimated_labor_hours": 2,
    "assigned_technician": "M-042"
  }
}
```

---

## 디지털 트윈 통합

### NVIDIA Omniverse 연동

```
┌──────────────────────────────────────────────────────────────────────┐
│                       디지털 트윈 통합                                │
├──────────────────────────────────────────────────────────────────────┤
│                                                                      │
│   Physical World                    Digital World                    │
│   ┌──────────────┐                 ┌──────────────────────────────┐ │
│   │ Press P-001  │ ─── OPC-UA ───► │      NVIDIA Omniverse        │ │
│   │ Robot R-023  │     / USD       │                              │ │
│   │ Pump  PU-012 │                 │   ┌────┐ ┌────┐ ┌────┐      │ │
│   └──────────────┘                 │   │ 🔴 │ │ 🟢 │ │ 🟡 │      │ │
│                                    │   │P001│ │R023│ │PU12│      │ │
│   🔴 Critical                      │   └────┘ └────┘ └────┘      │ │
│   🟡 Warning                       │                              │ │
│   🟢 Normal                        │   • 실시간 상태 시각화       │ │
│                                    │   • What-if 시뮬레이션       │ │
│                                    │   • AR 정비 가이드           │ │
│                                    └──────────────────────────────┘ │
│                                                                      │
└──────────────────────────────────────────────────────────────────────┘
```

---

## 배포 및 운영

### Docker Compose 구성

```yaml
# docker-compose.tier3.yml
version: '3.8'

services:
  sensor-collector:
    image: tier3/sensor-collector:latest
    runtime: nvidia
    privileged: true

  inference-engine:
    image: tier3/inference-engine:latest
    runtime: nvidia
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]

  edge-llm:
    image: ollama/ollama:latest
    runtime: nvidia
    ports:
      - "11434:11434"

  agent-orchestrator:
    image: tier3/agent:latest
    depends_on:
      - edge-llm
      - inference-engine

  voice-interface:
    image: tier3/voice:latest
    runtime: nvidia
    devices:
      - /dev/snd:/dev/snd

  influxdb:
    image: influxdb:2.7
    ports:
      - "8086:8086"

  grafana:
    image: grafana/grafana:10.2.0
    ports:
      - "3000:3000"
```

### 배포 절차

```bash
# 1. 시스템 준비 (Jetson AGX Orin)
sudo apt update && sudo apt upgrade -y
sudo apt install -y nvidia-jetpack docker.io docker-compose

# 2. NVIDIA Container Runtime 설정
sudo nvidia-ctk runtime configure --runtime=docker
sudo systemctl restart docker

# 3. 모델 다운로드
docker exec -it edge-llm ollama pull phi3:mini

# 4. 서비스 시작
docker-compose -f docker-compose.tier3.yml up -d

# 5. 헬스체크
curl http://localhost:8080/health
```

---

## 비용 분석

### 초기 투자 비용 (50대 설비 기준)

| 구분 | 항목 | 단가 | 수량 | 소계 |
|:----:|------|-----:|:----:|-----:|
| **Edge AI** | Jetson AGX Orin 32GB | $999 | 10 | $9,990 |
| **센서 패키지** | 5채널 멀티모달 세트 | $820 | 50 | $41,000 |
| **데이터 수집** | STM32H7 + ADC 보드 | $50 | 50 | $2,500 |
| **음성 인터페이스** | 마이크 어레이 + 스피커 | $80 | 50 | $4,000 |
| **산업 통신** | EtherCAT/PROFINET | $80 | 50 | $4,000 |
| **케이스/전원** | IP65 인클로저 세트 | $150 | 50 | $7,500 |
| **설치** | 케이블/마운트/공임 | $200 | 50 | $10,000 |
| | | | **총계** | **$78,990** |

### 자산당 비용

```
┌─────────────────────────────────────────────────────────────────────────┐
│  Jetson AGX Orin 공유 모델 (1대당 5설비)                                │
│                                                                         │
│  • Edge AI (공유): $999 ÷ 5 = $200/자산                                │
│  • 센서 패키지: $820/자산                                               │
│  • 데이터 수집: $50/자산                                                │
│  • 음성 인터페이스: $80/자산                                            │
│  • 통신/케이스/설치: $430/자산                                          │
│  ─────────────────────────────────────────────────────────────────────  │
│  총 자산당 비용: $1,580/자산                                            │
│                                                                         │
│  * 대량 구매 시 목표 단가: $300~500/자산 (볼륨 디스카운트 적용)         │
└─────────────────────────────────────────────────────────────────────────┘
```

### ROI 분석

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          ROI 분석                                       │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  가정:                                                                  │
│  • 대상 설비: 50대 (핵심 병목)                                         │
│  • 평균 비계획 정지: 연 12회/설비                                      │
│  • 정지당 손실: $15,000                                                │
│  • 예지보전 정지 감소율: 70%                                           │
│                                                                         │
│  ─────────────────────────────────────────────────────────────────────  │
│                                                                         │
│  기존 손실: 50 × 12 × $15,000 = $9,000,000/년                          │
│  절감 효과: $9,000,000 × 70% = $6,300,000/년                           │
│                                                                         │
│  초기 투자: $78,990                                                     │
│  연간 운영: $42,000                                                     │
│                                                                         │
│  ─────────────────────────────────────────────────────────────────────  │
│  1년차 순이익: $6,300,000 - $78,990 - $42,000 = $6,179,010             │
│  ROI: 5,112%                                                            │
│  투자 회수 기간: 약 7일                                                 │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 참고 자료

### 외부 자료

| 분류 | 자료명 | 링크 |
|:----:|--------|------|
| **NVIDIA** | Jetson AGX Orin Developer Kit | [링크](https://developer.nvidia.com/embedded/jetson-agx-orin-developer-kit) |
| **NVIDIA** | Omniverse Digital Twin | [링크](https://www.nvidia.com/en-us/omniverse/solutions/digital-twins/) |
| **Ollama** | Local LLM Deployment | [링크](https://ollama.ai/) |
| **LangChain** | Agentic AI Framework | [링크](https://python.langchain.com/) |
| **OpenAI** | Whisper Speech Recognition | [링크](https://github.com/openai/whisper) |

### 데이터셋

| 데이터셋 | 용도 | 링크 |
|:--------:|------|------|
| CWRU Bearing | 베어링 고장 분류 | [링크](https://engineering.case.edu/bearingdatacenter) |
| NASA C-MAPSS | RUL 예측 | [링크](https://www.nasa.gov/content/prognostics-center-of-excellence-data-set-repository) |
| MIMII | 산업 음향 이상 탐지 | [링크](https://zenodo.org/record/3384388) |

---

## 버전 이력

| 버전 | 날짜 | 변경 내용 |
|:----:|:----:|----------|
| 1.0 | 2025-02-10 | 초기 버전 작성 |

---

*문서 작성: AI Assistant*
*최종 업데이트: 2025년 2월 10일*
